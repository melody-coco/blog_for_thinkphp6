<center>sqli-labs总结</center>

> 此章为sqli-labs的总结笔记。主要包裹在sqli-labs中的过关概况，测试注入点，绕过方法，注入姿势



### 1.	测试注入点



> 以下情况，哪种出现了报错信息则表示哪种为注入点



#### 1.	单引号

有些后端数据是被单引号包裹进sql语句的，所以在此处只需要使用`'`单引号进行打断。出现报错就表示此处有注入点。



然后用`%23`注释掉后端的语句和单引号就行了。（ps.`%23`，url解码后是#。）



例如：

```
select * from users where id='前端数据' limit 0,1;
```





测试实例：

```
?id=1' and 1=1%23
?id=1' and 1=2%23
？id=1'='0
```



#### 2.	双引号

有些后端数据是被单引号包裹进sql语句的，所以在此处只需要使用`"`双引号进行打断。出现报错就表示此处有注入点。

然后用`%23`注释掉后端的语句和单引号就行了。（ps.`%23`，url解码后是#。）



例如:

```
select * from users where id="前端数据" limit 0,1;
```





测试实例：

```
?id=1" and 1=1%23
?id=1" and 1=2%23
?id=1"="0
```





#### 3.	单引号＋括号



有些后端数据是被单引号和括号包裹进sql语句的，所以此处只需要使用`'`单引号和`()`小括号进行打断就行了。出现报错就表示此处有注入点。

然后用`%23`进行注释掉后端的语句就行了。（ps.`%23`，url解码后是#。）





例如：

```
select * from users where id=('前端数据') limit 0,1;
```





测试实例：

```
?id=1') and 1=1%23
?id=1') and 1=2%23
?id=1')=('0
```





#### 4.	双引号+括号



有些后端数据是被单引号和括号包裹进sql语句的，所以此处只需要使用`"`双引号和`()`小括号进行打断就行了。出现报错就表示此处有注入点。

然后用`%23`进行注释掉后端的语句就行了。（ps.`%23`，url解码后是#。）



例如：

```
select * from users where id=("前端数据") limit 0,1;
```





测试实例：

```
?id=1") and 1=1%23
?id=1") and 1=2%23
?id=1")=("0
```





#### 5.	未包裹



有些后端数据未使用特殊符号进行包裹就直接带进sql语句了。

所以测试`'`单引号,`"`双引号,`()`小括号都会报错。

此处只需要测试`1 and 1=1%23`和`1 and 1=2%23`。如果两次页面返回的不一样，则表示我们的语句生效了。于是乎，就能进行sql注入。



实例：

```
select * from users where id=前端数据 limit 0,1;
```



测试实例：

```
?id=1 and 1=1%23					
?id=1 and 1=2%23
?id=1=0
```







#### 6.	%23

%23转码后为`#`。浏览器自带有一些过滤规则，url定位符中的`#`，可能会被过滤掉。所以一般都是使用`%23`

#### .	POST类型



以上1~5都是针对get类型，而对于POST类型的话，差别也不大。如下



>不过需要注意的是因为post类型不需要url转码，所以`#`无需写为`%23`。宽字节绕过`�`也无需写为`%bf`



实例：

```
usersname:1' or 1=1#						单引号

usersname:1" or 1=1#						双引号

usersname:1') or 1=1#						单引号＋小括号

usersname:1") or 1=1#						双引号+小括号
```





#### 其他注入类型

> 如cookie注入，referer注入，User-Agent注入都是和get类型注入同样的道理，只是也不需要进行`url`转码

关于其他注入类型的话，建议直接看一下`sqli-labs`的通关详解。



包括：cookie注入，referer注入，User-Agent注入。以及对应的insert语句注入，update语句注入。以及`order by`注入 





### 2.	绕过方式



#### 1. 注释绕过，

注释的本身作用在于帮助`'`单引号的特殊符号来闭合。也就是注释输入数据后面的符号。



注释被过滤掉了的话，只需要分别闭合前后端的闭合符号就行了



例如：

```
?id=1' or extractvalue(1,concat(0x7e,(select database()))) or id='-1
```





#### 2.	二次注入



> 此处就不说了，要了解的话。自己去看`sqli-labs`的第24题。



#### 3.	双写绕过



>  此处就不说了，要了解的话。自己去看`sqli-labs`的第25题。





#### 4.	绕过空格



> 绕过空格的话，应巧妙使用`()`。此处不做赘述，自己去看`sqli-labs`27.a题





#### 5.	绕过waf



此处`sqli-labs`题中的waf我使用的都是`http`参数污染。





#### 6.	宽字节绕过



通过给`'`单引号前面添加，`%bf`来使前面转义的`\`和`%bf`结合为新的字符。使`\`无效。



实例：

```
?id=1%bf' and 1=1%23
```



如果是在post注入中要使用宽字节注入，则需要使用`�`。这是因为`%bf`url解码了后就是`�`，而post传数据不会进行url解码。







### 3.	注入方式



详细的注入方式此处就不说了，只写写对注入方式的选择。



##### `union`注入

必须要有具体的回显点，如果没有的话则不能使用union注入。union注入局限性也蛮大的。



##### 盲注，

无论是`bool`注入还是时间盲注。都能适应比较恶劣的情况。不过bool注入还是需要页面的大致的回显。而时间盲注则不需要有具体的回显，只需要通过执行时间来判断语句是否生效即可



##### 报错注入。

作为我最喜欢的注入方式，简单粗暴。只要前端能回显`mysql`的报错信息，几乎都能够使用报错注入。不过报错注入重要的一点是：构造正确的语句语法才能注入。如果语句本身是有问题的，那么报错注入抛出的错误会被mysql语句的错误给掩盖。



##### 堆叠注入

堆叠注入算是最牛批的注入，不像上面的注入方式都有一定的局限性(ps.此局限性说的是：注入产生的效果的局限性)。堆叠注入则能相对mysql做什么就对mysql做什么。不过堆叠有时候的局限性也很大。比如很多地方不能有堆叠注入，很多时候堆叠注入的信息不会回显，很多时候堆叠注入需要数据库结构才能进行注入。



##### 二次注入

二次注入的情况其实比较特殊，是在于修改等界面。后端开发人员没有写好的原因导致的。





##### cookie注入

`cookie`，`ua`注入。都算在`cookie`注入当中。其原理都是差不多的，都是通过后端获取请求头中的字段参数，然后进行数据库的操作









### 4.	sql注入过程





##### 1.探测注入点

通过`'`,`"`,`()`，`and`,`or`,`%23`,`#`来探测注入点的存在。如果页面回显不正常的话则表示前端报错，当然这里的回显不正常的情况，要具体分析。根据具体的情况决定使用哪种注入方式



> 当然，如果有过滤的情况出现的话，就得考虑探测注入点的情况了。
>
> 例如：过滤了注释，或者空格的情况出现





注意：在44题中，注入点在密码，但是此题不会回显报错信息。注入失败的话，直接弹出的是登录失败的页面。

> 而我们本来就不知道登录的密码是多少。所以很容易就让人感觉此题没有注入点







##### 2.测试语句是否生效

> 测试语句是否生效的同时其实也在测试过滤的情况。

前面以及探测出了注入点，然后探测语句是否生效。例如：

```
?id=1' and 1=1%23					或			?id=1' and 1=2%23
```

> 通过`and 1=1`和`and 1=2`来探测语句是否生效。





##### 3.开始注入

此处要根据页面的回显确定使用哪种注入方式。然后开始注入



> 此处如果有堆叠注入漏洞的话。还可以探测完数据库结构后进行堆叠注入